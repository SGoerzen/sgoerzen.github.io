---
import {Send} from "lucide-react";
import { Button } from './ui/button';
type Props = {
  title?: string;
  description?: string;
};

const {
  title = "Kontakt",
  description = "Schreib mir kurz, worum es geht — ich melde mich zeitnah zurück.",
} = Astro.props as Props;

---

<!--<Button
  type="button"
>
    <Send/>
    <span class="ml-2">Kontaktformular</span>
</Button>-->

<dialog
  id="contact-form"
  class="w-full max-w-2xl rounded-xl border border-black/10 bg-white p-0 text-black shadow-xl dark:border-white/20 dark:bg-zinc-950 dark:text-white"
>
  <div class="flex items-start justify-between gap-4 border-b border-black/10 p-4 dark:border-white/20">
    <div>
      <h2 class="text-lg font-semibold">{title}</h2>
      <p class="mt-1 text-sm text-gray-600 dark:text-gray-300">{description}</p>
    </div>

    <button
      type="button"
      class="rounded-md border border-black/10 px-3 py-1 text-sm hover:bg-black/5 dark:border-white/20"
      data-close-dialog="contact-form"
      aria-label="Dialog schließen"
    >
      ✕
    </button>
  </div>

  <div class="p-4">
      <form action="https://fabform.io/f/your-form-endpoint" method="POST">
          <label for="name">Name:</label>
          <input type="text" id="name" name="name" required />

          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required />

          <label for="message">Message:</label>
          <textarea id="message" name="message" required></textarea>

          <button type="submit">Send</button>
      </form>
  </div>
</dialog>

<script is:inline>
    (() => {
        const openBtn = document.querySelector(`[data-open-dialog="contact-form"]`);
        const closeBtn = document.querySelector(`[data-close-dialog="contact-form"]`);
        const dialog = document.getElementById("contact-form");

        if (!openBtn || !dialog) return;

        const isDialogSupported = typeof dialog.showModal === "function";

        const open = () => {
            if (isDialogSupported) dialog.showModal();
            else dialog.setAttribute("open", "true");
        };

        const close = () => {
            if (dialog.open) dialog.close();
            else dialog.removeAttribute("open");
            openBtn.focus();
        };

        openBtn.addEventListener("click", open);
        closeBtn?.addEventListener("click", close);

        dialog.addEventListener("cancel", (e) => {
            e.preventDefault();
            close();
        });

        dialog.addEventListener("click", (e) => {
            const rect = dialog.getBoundingClientRect();
            const inDialog =
                rect.top <= e.clientY &&
                e.clientY <= rect.bottom &&
                rect.left <= e.clientX &&
                e.clientX <= rect.right;

            if (!inDialog) close();
        });
    })();
</script>


<style>
  /* nicer backdrop */
  dialog::backdrop {
    background: rgba(0, 0, 0, 0.4);
  }
</style>
